

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Zigbee ZCL scene helper &mdash; Zigbee add-on for nRF Connect SDK 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/nordic.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/nordic.css" type="text/css" />
  <link rel="stylesheet" href="../_static/togglebutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />

  
  

  
  

  

  
  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
  <script type="text/javascript" src="../_static/js/ncs.js"></script>

    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tools" href="../tools.html" />
    <link rel="prev" title="Zigbee endpoint logger" href="zigbee_logger_eprxzcl.html" />
  <link rel="shortcut icon" href="../_static/images/favicon.ico"/>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Zigbee add-on for nRF Connect SDK
          

          
          </a>

          
            
            
          

          
<div id="searchbox" role="search">
  <div class="searchformwrapper">
    <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
  </div>
</div>
<script>$('#searchbox').show(0);</script>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About Zigbee protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup.html">Requirements and setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick-start.html">Quick start guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architectures.html">Architectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commissioning.html">Commissioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../memory.html">Memory requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuring.html">Configuring Zigbee add-on</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuring/index.html">Additional configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zboss/index.html">ZBOSS Zigbee stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/index.html">Samples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Libraries for Zigbee</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="osif.html">Zigbee ZBOSS OSIF</a></li>
<li class="toctree-l2"><a class="reference internal" href="shell.html">Zigbee shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="zigbee_app_utils.html">Zigbee application utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="zigbee_error_handler.html">Zigbee error handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="zigbee_logger_eprxzcl.html">Zigbee endpoint logger</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Zigbee ZCL scene helper</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#api-documentation">API documentation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes.html">Release notes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Zigbee add-on for nRF Connect SDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Libraries for Zigbee</a> &raquo;</li>
        
      <li>Zigbee ZCL scene helper</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/lib/zigbee_zcl_scenes.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="zigbee-zcl-scene-helper">
<span id="lib-zigbee-zcl-scenes"></span><h1>Zigbee ZCL scene helper<a class="headerlink" href="#zigbee-zcl-scene-helper" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#configuration" id="id3">Configuration</a></p></li>
<li><p><a class="reference internal" href="#api-documentation" id="id4">API documentation</a></p></li>
</ul>
</div>
<p>The Zigbee ZCL scene helper library provides a set of functions that implement the callbacks required by the ZCL scene cluster in the application.
You can use this library to implement these mandatory callbacks and save the configured scenes in the non-volatile memory.
For this purpose, it uses Zephyr’s <a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/zephyr/services/settings/index.html">Settings</a> subsystem.</p>
<p>This library is capable of recalling attribute values for the following ZCL clusters:</p>
<ul class="simple">
<li><p>On/off</p></li>
<li><p>Level control</p></li>
<li><p>Window covering</p></li>
</ul>
<p>If you are implementing clusters that are not included in this list, you must implement their logic manually instead of using this library.</p>
<div class="section" id="configuration">
<span id="lib-zigbee-zcl-scenes-options"></span><h2><a class="toc-backref" href="#id3">Configuration</a><a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>To enable the Zigbee ZCL scene helper library, set the <code class="docutils literal notranslate"><span class="pre">CONFIG_ZIGBEE_SCENES</span></code> Kconfig option.</p>
<p>Because the library uses Zephyr’s <a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/zephyr/services/settings/index.html">Settings</a> subsystem, the application must call the following functions for the library to work correctly:</p>
<ul class="simple">
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">zcl_scenes_init()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">zcl_scenes_cb()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">settings_subsys_init()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">settings_load()</span></code></p></li>
</ul>
<p>You must implement these functions in the following manner:</p>
<ul>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">settings_subsys_init()</span></code> must be called before <code class="xref c c-func docutils literal notranslate"><span class="pre">zcl_scenes_init()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">settings_load()</span></code> must be called after <code class="xref c c-func docutils literal notranslate"><span class="pre">zcl_scenes_init()</span></code></p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">zcl_scenes_cb()</span></code> must be called in the ZCL device callback:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">void</span> <span class="nf">zcl_device_cb</span><span class="p">(</span><span class="n">zb_bufid_t</span> <span class="n">bufid</span><span class="p">)</span>
<span class="p">{</span>
   <span class="n">zb_zcl_device_callback_param_t</span>  <span class="o">*</span><span class="n">device_cb_param</span> <span class="o">=</span>
      <span class="n">ZB_BUF_GET_PARAM</span><span class="p">(</span><span class="n">bufid</span><span class="p">,</span> <span class="n">zb_zcl_device_callback_param_t</span><span class="p">);</span>
   <span class="k">switch</span> <span class="p">(</span><span class="n">device_cb_param</span><span class="o">-&gt;</span><span class="n">device_cb_id</span><span class="p">)</span> <span class="p">{</span>
   <span class="p">...</span>
   <span class="k">default</span><span class="o">:</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">zcl_scenes_cb</span><span class="p">(</span><span class="n">bufid</span><span class="p">)</span> <span class="o">==</span> <span class="n">ZB_FALSE</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">device_cb_param</span><span class="o">-&gt;</span><span class="n">status</span> <span class="o">=</span> <span class="n">RET_ERROR</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">break</span><span class="p">;</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
<p>Setting the <code class="docutils literal notranslate"><span class="pre">CONFIG_ZIGBEE_SCENES</span></code> Kconfig option allows you to configure the following library-specific Kconfig options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ZIGBEE_SCENES_ENDPOINT</span></code> - This option sets the endpoint number on which the device implements the ZCL scene cluster.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ZIGBEE_SCENE_TABLE_SIZE</span></code> - This option sets the value for the number of scenes that can be configured.</p></li>
</ul>
<p>To configure the logging level of the library, use the <code class="docutils literal notranslate"><span class="pre">CONFIG_ZIGBEE_SCENES_LOG_LEVEL</span></code> Kconfig option.</p>
</div>
<div class="section" id="api-documentation">
<h2><a class="toc-backref" href="#id4">API documentation</a><a class="headerlink" href="#api-documentation" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">Header file: <code class="file docutils literal notranslate"><span class="pre">include/zigbee/zigbee_zcl_scenes.h</span></code></div>
<div class="line">Source file: <code class="file docutils literal notranslate"><span class="pre">subsys/zigbee/lib/zigbee_scenes/zigbee_zcl_scenes.c</span></code></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>doxygengroup: Cannot find file: C:\work\Zigbee\ncs-zigbee\ncs-zigbee\docs\_build_doxygen\xml\index.xml</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../tools.html" class="btn btn-neutral float-right" title="Tools" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="zigbee_logger_eprxzcl.html" class="btn btn-neutral" title="Zigbee endpoint logger" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">

<table>
<tr>
<td>
    <p>
        &copy; Copyright 2024, Nordic Semiconductor.

    </p>
</td>
<td id="nordiclogo">
  <a href="https://www.nordicsemi.com/"><img src="../_static/images/nordic.svg" border="0"/></a>
</td>
</tr>
</table>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 


</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>